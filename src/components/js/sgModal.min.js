class sgModal{constructor(t){t&&(this.#a={...this.#a,...t}),sgModal.instances.push(this)}#a={columns:[],title:"",action:"",primaryColor:"",deleteTitleItemField:"",bodyTemplate:"",okCallback(){},footer:{direction:""}};static instances=[];#b="string";#c=void 0;#d=void 0;#e="sg-form-field";#f={string:"",number:0};#g={add:"Nuevo registro",edit:"Editar registro",delete:"Eliminar"};#h={string:"text",number:"number",object:"date"};#i={input:(t,e)=>this.#j(t,e),dropdown:(t,e)=>this.#k(t,e)};#l={crud:()=>this.#m(),custom:()=>this.#n(),"":()=>""};openModal(){let t=document.getElementsByTagName("body")[0],e=this.#o();document.getElementsByClassName("sg-modal-wrapper")[0].innerHTML=e;let l=document.getElementsByClassName("sg-modal")[0],a=document.getElementsByClassName("sg-modal-backdrop")[0];a.classList.add("show"),l.style.display="block",t.classList.add("sg-modal-open");let o=setTimeout(()=>{l.classList.add("show"),clearTimeout(o)},100);this.#p(l),this.#q(l)}closeModal=()=>{let t=document.getElementsByClassName("sg-modal-wrapper")[0];document.body.classList.remove("sg-modal-open");let e=document.getElementsByClassName("sg-modal")[0],l=document.getElementsByClassName("sg-modal-backdrop")[0];e.classList.remove("show");let a=setTimeout(()=>{l.classList.remove("show"),clearTimeout(a)},100),o=setTimeout(()=>{e.style.display="none",t&&t.parentElement?.removeChild(t),clearTimeout(o)},200);this.#r()};setRowDataItem=t=>(this.#d=t,this);setRowIndex=t=>{this.#c=t};setDeleteTitleField(t){this.#a.deleteTitleItemField=t}action(t){return this.#a.action=t,this}#o=()=>{let t=document.createElement("div");t.classList.add("sg-modal-wrapper"),t.setAttribute("tabindex","-1"),t.style.position="relative",t.style.zIndex="1050",t.style.display="block",document.body.appendChild(t);let e=` <div>
                  #modal#
                  #backdrop#
            </div>`,l=backdropTemplate,a="",o=this.#l[this.#a.mode];return a=o(),e=e.replace("#modal#",a).replace("#backdrop#",l)};#n(){let t=modalTemplate;return t.replace("#headertitle#",this.#a.title||"").replace("#body#",this.#a.bodyTemplate).replace("#footer#",modalFooterTemplate.replace("#action#",this.#a.action)).replace("#repeat#","1")}#m(){let e="";return("edit"==this.#a.action||"add"==this.#a.action)&&(e=this.#s()),"delete"==this.#a.action&&(e=this.#t()),e}#s(){let l=modalTemplate,a=this.#u();return l.replace("#headertitle#",this.#a.title||"").replace("#body#",a).replace("#footer#",modalFooterTemplate.replace("#action#",this.#a.action)).replace("#repeat#","2")}#t(){let o="";try{o=this.#d[this.#a.deleteTitleItemField]?" "+this.#d[this.#a.deleteTitleItemField]:""}catch(s){o=" "}let i=modalTemplate;return i.replace("#headertitle#",this.#a.title||"").replace("#body#",`<p>\xbfConfirma eliminar el registro${o||""}?</p>`).replace("#footer#",modalFooterDeleteTemplate.replace("#action#",this.#a.action)).replace("#repeat#","1")}#p=t=>{t.getElementsByClassName("sg-modal-button-close")[0].addEventListener("click",this.closeModal);try{t.getElementsByClassName("sg-modal-button-save")[0].addEventListener("click",t=>this.#v(t))}catch(e){}try{let l=t.getElementsByClassName("sg-form-field");Array.from(l).forEach((t,e)=>{let a=l[e];a.addEventListener("change",t=>this.#w(t))})}catch(a){}try{t.getElementsByClassName("sg-modal-button-delete")[0].addEventListener("click",t=>this.#v(t))}catch(o){}};#j=(t,e)=>{let l;try{let a={dataItem:this.#d,action:this.#a.action};l=e(a)}catch(o){}let s=`<input type="${this.#b}" 
            name="${t}" ${l?"disabled":""} 
            class="${this.#e}" value="#value#"/>`;if(this.#d){let i=this.#d[t];s=s.replace("#value#",i)}else s=s.replace("#value#","");return s};#k=(t,e)=>{let l=this.#a.columns.find(e=>e.field==t);if(!l)throw Error("No se encontr\xf3 la columna");let a=l.editor?.source,o=`<select name="${t}" class="${this.#e}">#options#</select>`,{textField:s,valueField:i}=l.editor,d=`<option value="null">Seleccione una opci\xf3n</option>`;return a?.forEach(e=>{let l='<option #selected# value="#value#">#text#</option>'.replace("#value#",e[i]).replace("#text#",e[s]);this.#d?this.#d[t]==e[i]&&(l=l.replace("#selected#","selected")):l=l.replace("#selected#",""),d+=l}),o.replace("#options#",d)};#x(d){let r="";try{r=d.editor?.type||"input"}catch(n){r="input"}return r}#u(){let{columns:m}=this.#a,c=this.#y(),p="";return c.forEach(t=>{let e=this.#x(t),l=this.#i[e];this.#b=this.#z(t);let a=l(t.field,t.editor?.disabled),o=t.title?t.title:t.field;p+=modalBlockTemplate.replace("#input#",a).replace("#controlName#",t.field).replace("#labeltext#",o)}),p}#A=t=>{let{primaryColor:e}=this.#a;["primary","secondary"].forEach(l=>{let a=l+"-color",o=t.getElementsByClassName(a);o=Array.from(o),"primary"==l?o.forEach(t=>{"button"==t.localName?(t.style.background=e,t.style.color="white"):t.style.color=e}):o.forEach(t=>{"button"==t.localName?(t.style.background="white",t.style.color=e,t.style.border=`1px solid ${e}`):t.style.color=e})})};#y(){let{columns:h}=this.#a,u=h.filter(t=>t.editor&&t.editor.editable),g=u.filter(t=>t.editor?.position),y=u.filter(t=>!t.editor?.position),b=g.sort((t,e)=>t.editor.position-e.editor.position),f=b.concat(y);return f}#z(v){let E="string";try{E=v.type||"string"}catch(C){}return E}#r(){this.#c=void 0,this.#b=void 0,this.#d=void 0}#w(T){let{name:I,value:O}=T.target;this.#d||(this.#d=this.#B()),this.#d={...this.#d,[I]:O}}#B(){let{columns:$}=this.#a,k={};return $.forEach(t=>{let{field:e,type:l}=t;l||(l="string"),k={...k,[e]:this.#f[l]}}),k}#v(B){let N={dataItem:this.#d,closeModal:this.closeModal};this.#a.okCallback(N)}#q(w){this.#A(w);let M=document.getElementsByClassName("sg-modal-footer")[0];this.#a.footer.direction&&M.classList.add(this.#a.footer.direction)}}const modalBlockTemplate=`
<div class="sg-modal-body-item">
    <label for="#controlName#">#labeltext#</label>
    #input#
</div>`,modalFooterTemplate=`
<div class="sg-modal-footer">
    <button type="button" action="#action#" class="sg-modal-button primary-color sg-modal-button-save">Guardar</button>
    <button  type="button" class="sg-modal-button secondary-color sg-modal-button-close">Cancelar</button>
</div>`,modalFooterDeleteTemplate=`
<div class="sg-modal-footer sg-modal-footer-delete">
    <button type="button" action="#action#" class="sg-modal-button primary-color sg-modal-button-delete">Confirmar</button>
    <button  type="button" class="sg-modal-button secondary-color sg-modal-button-close">Cancelar</button>
</div>`,modalTemplate=`<div class="sg-modal fade" role="dialog" tabindex="-1">
<div class="sg-modal-dialog" role="document">
    <div class='sg-modal-content'>
        <form action="#">
            <div class="sg-modal-header">
                <h5 class="sg-modal-title">#headertitle#</h5>
            </div>
            <div class="sg-modal-body" style="grid-template-columns: repeat(#repeat#, 1fr);">
                 #body#
            </div>
            #footer#
        </form>
    </div>
</div>
</div>`,backdropTemplate='<div class="sg-modal-backdrop fade show"></div>';